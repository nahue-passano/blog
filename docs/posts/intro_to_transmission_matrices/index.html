<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Introduction to Transmission Matrices - </title><meta name=Description content="This is my cool site"><meta property="og:title" content="Introduction to Transmission Matrices"><meta property="og:description" content="Introducción a matrices de transmisión Cuadripolos Las matrices de transmisión surgen a partir de las ecuaciones que caracterízan a los cuadripolos. De forma general, la matriz que caracteriza la transmisión de un cuadripolo se puede definir como:
$$ T =\begin{bmatrix} t_{11} & t_{12} \\ t_{21} & t_{22} \end{bmatrix} $$ donde cada uno de los valores de la matriz $T$ representa una relación especifica entre la entrada y la salida del cuadripolo."><meta property="og:type" content="article"><meta property="og:url" content="https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-01T01:06:37-03:00"><meta property="article:modified_time" content="2024-04-01T01:06:37-03:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introduction to Transmission Matrices"><meta name=twitter:description content="Introducción a matrices de transmisión Cuadripolos Las matrices de transmisión surgen a partir de las ecuaciones que caracterízan a los cuadripolos. De forma general, la matriz que caracteriza la transmisión de un cuadripolo se puede definir como:
$$ T =\begin{bmatrix} t_{11} & t_{12} \\ t_{21} & t_{22} \end{bmatrix} $$ donde cada uno de los valores de la matriz $T$ representa una relación especifica entre la entrada y la salida del cuadripolo."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/><link rel=stylesheet href=/blog/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Introduction to Transmission Matrices","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nahue-passano.github.io\/blog\/posts\/intro_to_transmission_matrices\/"},"genre":"posts","wordcount":2274,"url":"https:\/\/nahue-passano.github.io\/blog\/posts\/intro_to_transmission_matrices\/","datePublished":"2024-04-01T01:06:37-03:00","dateModified":"2024-04-01T01:06:37-03:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Nahuel Passano"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/blog/ title>nahue-passano's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/blog/posts/>Posts </a><a class=menu-item href=/blog/about/>About me </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/blog/posts/intro_to_transmission_matrices/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/blog/ title>nahue-passano's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/blog/posts/ title>Posts</a><a class=menu-item href=/blog/about/ title>About me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/blog/posts/intro_to_transmission_matrices/ selected>English</option></select></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Introduction to Transmission Matrices</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://linkedin.com/in/nahuelpassano title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Nahuel Passano</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-04-01>2024-04-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2274 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;11 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#cuadripolos>Cuadripolos</a></li><li><a href=#matrices-de-transmisión>Matrices de transmisión</a></li><li><a href=#ejemplo-1-divisor-de-tensión>Ejemplo 1: Divisor de tensión</a></li><li><a href=#ejemplo-2-filtro-pasabanda>Ejemplo 2: Filtro pasabanda</a></li><li><a href=#ejemplo-3-filtro-resonante>Ejemplo 3: Filtro resonante</a></li></ul></nav></div></div><div class=content id=content><h1 id=introducción-a-matrices-de-transmisión>Introducción a matrices de transmisión</h1><h2 id=cuadripolos>Cuadripolos</h2><p>Las matrices de transmisión surgen a partir de las ecuaciones que caracterízan a los cuadripolos. De forma general, la matriz que caracteriza la transmisión de un cuadripolo se puede definir como:</p><div>$$
T =\begin{bmatrix}
t_{11} & t_{12} \\
    t_{21} & t_{22}
   \end{bmatrix}
$$</div><p>donde cada uno de los valores de la matriz $T$ representa una relación especifica entre la entrada y la salida del cuadripolo.</p><div>$$
\begin{align*}
t_{11} &= \frac{v_{in}}{v_{out}} \bigg|_{i_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_v)\\
t_{12} &= \frac{v_{in}}{i_{out}} \bigg|_{i_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_Y)\\
t_{21} &= \frac{i_{in}}{v_{out}} \bigg|_{v_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_Z)\\
t_{22} &= \frac{i_{in}}{i_{out}} \bigg|_{v_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_i)\\
\end{align*}
$$</div><p>Como se puede ver, hay dos condiciones sobre las cuales se especifican los elementos.</p><ul><li>$v_{out} = 0$: Significa que la tensión de salida es nula, por lo que los conectores de salida estan cortocircuitados.</li><li>$i_{out} = 0$: Significa que la corriente de salida es nula, por lo que los conectores de salida estan abiertos.</li></ul><p>Dicha matriz nos dice como obtener las variables de entrada en función de las variables de salida:</p><div>$$
\begin{equation*}
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
T \cdot
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
t_{11} & t_{12} \\
            t_{21} & t_{22}
\end{bmatrix}
\cdot
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
t_{11} \cdot v_{out} + t_{12} \cdot i_{out}\\
t_{21} \cdot v_{out} + t_{22} \cdot i_{out}
\end{bmatrix}
\end{equation*}
$$</div><p>Por lo que para obtener los variables de salida en función de las variables de entrada, debemos invertir la matriz de transmisión y aplicarla a las variables de entrada.</p><div>$$
T^{-1} =
\frac{1}{\det(T)} \cdot
\begin{bmatrix}
t_{22} & -t_{12} \\
        -t_{21} & t_{11}
\end{bmatrix}
$$</div><div>$$
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
T \cdot
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
\hspace{4mm} \rightarrow \hspace{4mm}
T^{-1} \cdot
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
t_{22} \cdot v_{in} - t_{12} \cdot i_{in}\\
-t_{21} \cdot v_{in} + t_{11} \cdot i_{in}
\end{bmatrix}
\cdot \frac{1}{\det(T)}
$$</div><h2 id=matrices-de-transmisión>Matrices de transmisión</h2><p>Cada componente que compone un circuito (ya sea eléctrico, mecánico o acústico) tiene su representación a través de un cuadripolo en forma matricial. De forma general, la representación matricial se diferencia si los componentes son de impedancia, admitancia o transformación.</p><p><strong>Matriz de transmisión de una impedancia ($T_Z$)</strong></p><div>$$
T_Z =
\begin{bmatrix}
1 & Z \\
    0 & 1
\end{bmatrix}
$$</div><p><strong>Matriz de transmisión de una admitancia ($T_Y$)</strong></p><div>$$
T_Y =
\begin{bmatrix}
1 & 0 \\
    Y & 1
\end{bmatrix}
$$</div><p><strong>Matriz de transmisión de un transformador ($T_T$)</strong></p><div>$$
T_T =
\begin{bmatrix}
n & 0 \\
    0 & 1/n
\end{bmatrix}
$$</div><p><strong>Matriz de transmisión de un girador ($T_G$)</strong></p><div>$$
T_G =
\begin{bmatrix}
0 & n \\
    1/n & 0
\end{bmatrix}
$$</div><h2 id=ejemplo-1-divisor-de-tensión>Ejemplo 1: Divisor de tensión</h2><p>Supongamos que vamos a analizar el siguiente divisor resistivo a través de las matrices de transmisión de cada componente para así obtener la transmisión total del sistema.</p><p align=center><img src=https://upload.wikimedia.org/wikipedia/commons/d/db/Resistive_divider.png width=30%></p><p>La idea es obtener una ecuación que relacione las magnitudes de salida (tensión y corriente de salida) en función de las magnitudes de entrada (tensión y corriente de entrada).</p><p>Primero se deben definir las matrices de ambos elementos. En este caso, $R_1$ está en serie, pero $R_2$ está en paralelo a la salida, por lo que su matriz de transmisión debe ser del tipo admitancia.</p><div>$$
T_{R_1} =
\begin{bmatrix}
1 & R_1 \\
        0 & 1
    \end{bmatrix}
$$</div><div>$$
T_{R_2} =
\begin{bmatrix}
1 & 0 \\
        \frac{1}{R_2} & 1
  \end{bmatrix}
$$</div><p>Realizando la multiplicación sucesiva de matrices de transmisión, la transferencia total será:</p><div>$$
T = T_{R_1} \cdot T_{R_2} =
\begin{bmatrix}
1 & R_1 \\
        0 & 1
    \end{bmatrix}
\cdot
\begin{bmatrix}
1 & 0 \\
        \frac{1}{R_2} & 1
  \end{bmatrix}
=
\begin{bmatrix}
1 + \frac{R_1}{R_2} & R_1 \\
        \frac{1}{R_2} & 1
\end{bmatrix}
$$</div><p>Recordando las ecuaciones descritas anteriormente, la relación entre las magnitudes de entrada y salida queda:</p><div>$$
\begin{equation*}
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
T \cdot
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
1 + \frac{R_1}{R_2} & R_1 \\
          \frac{1}{R_2} & 1
\end{bmatrix}
\cdot
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
(1 + \frac{R_1}{R_2}) \cdot v_{out} + R_{1} \cdot i_{out}\\
\frac{1}{R_2} \cdot v_{out} + i_{out}
\end{bmatrix}
\end{equation*}
$$</div><p>Pero lo que nos importa en la mayoría de los casos, es obtener las magnitudes de salida en función de las de entrada, por lo que:</p><div>$$
T^{-1} =
\begin{bmatrix}
1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
\end{bmatrix}
\cdot \underbrace{\det(T)}_{=1} =
\begin{bmatrix}
1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
\end{bmatrix}
$$</div><p>Ahora si podemos obtener la tensión y corriente de salida en función de la tensión y corriente de entrada.</p><div>$$
T^{-1} \cdot
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
\begin{bmatrix}
1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
\end{bmatrix}
\cdot
\begin{bmatrix}
v_{in} \\
i_{in}
\end{bmatrix}
=
\begin{bmatrix}
v_{out} \\
i_{out}
\end{bmatrix}
=
\begin{bmatrix}
v_{in} - R_{1} \cdot i_{in}\\
-\frac{1}{R_2} \cdot v_{in} + (1 + \frac{R_1}{R_2}) \cdot i_{in}
\end{bmatrix}
$$</div><div>$$
\begin{align*}
v_{out} = v_{in} - R_{1} \cdot i_{in} = v_{in} - v_{R_1} \\
i_{out} = \frac{1}{R_2} \Big ( -v_{in} + R_1 i_{in} + R_2 i_{in}\Big)
\end{align*}
$$</div><p>En Python todo este cálculo se puede hacer de forma simbólica con la libraría sympy</p><ol><li><p>Se definen los simbolos a utilizar y se generan las matrices de transmision para los elementos del circuito.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sympy</span> <span class=k>as</span> <span class=nn>sp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R1</span><span class=p>,</span> <span class=n>R2</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>symbols</span><span class=p>(</span><span class=s1>&#39;R1 R2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R1_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=n>R1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R2_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=n>R2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div></li><li><p>Se calcula la transmisión total haciendo la multiplicación sucesiva de matrices.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Total transmission matrix</span>
</span></span><span class=line><span class=cl><span class=n>total_tmatrix</span> <span class=o>=</span> <span class=n>R1_tmatrix</span> <span class=o>*</span> <span class=n>R2_tmatrix</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>total_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Inverse total transmission matrix</span>
</span></span><span class=line><span class=cl><span class=n>inverse_total_tmatrix</span> <span class=o>=</span> <span class=n>total_tmatrix</span><span class=o>.</span><span class=n>inv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>inverse_total_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Voltage gain response</span>
</span></span><span class=line><span class=cl><span class=n>voltage_gain_response</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>simplify</span><span class=p>((</span><span class=mi>1</span><span class=o>/</span><span class=n>total_tmatrix</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>voltage_gain_response</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>Multiplicando la matriz de transmisión inversa por las magnitudes de entrada queda:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>v_in</span><span class=p>,</span> <span class=n>i_in</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>symbols</span><span class=p>(</span><span class=s1>&#39;v_in i_in&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>output</span> <span class=o>=</span> <span class=n>inverse_total_tmatrix</span> <span class=o>*</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>([</span><span class=n>v_in</span><span class=p>,</span> <span class=n>i_in</span><span class=p>])</span>
</span></span></code></pre></div></li></ol><h2 id=ejemplo-2-filtro-pasabanda>Ejemplo 2: Filtro pasabanda</h2><p align=center><img src=https://www.researchgate.net/profile/Jonathan-Estevez-Fernandez/publication/312549075/figure/fig3/AS:452414026326019@1484875317721/Figura-5-Filtro-pasa-banda.png width=70%></p><ol><li><p>Se definen los simbolos a utilizar y se generan las matrices de transmision para los elementos del circuito.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sympy</span> <span class=k>as</span> <span class=nn>sp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_C1</span><span class=p>,</span> <span class=n>X_C2</span><span class=p>,</span> <span class=n>R1</span><span class=p>,</span> <span class=n>R2</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>symbols</span><span class=p>(</span><span class=s1>&#39;X_C1 X_C2 R1 R2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_C1_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=n>X_C1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R1_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=n>R1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R2_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=n>R2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_C2_tmatrix</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>Matrix</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=n>X_C2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div></li><li><p>Se calcula la transmisión total haciendo la multiplicación sucesiva de matrices. En este caso, se busca la respuesta en magnitud y fase de la tensión del sistema, por lo que debemos obtener la experesión de la ganancia de tensión a partir de la matriz de transmisión.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Total transmission matrix</span>
</span></span><span class=line><span class=cl><span class=n>total_tmatrix</span> <span class=o>=</span> <span class=n>X_C1_tmatrix</span> <span class=o>*</span> <span class=n>R1_tmatrix</span> <span class=o>*</span> <span class=n>R2_tmatrix</span> <span class=o>*</span> <span class=n>X_C2_tmatrix</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>total_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Inverse total transmission matrix</span>
</span></span><span class=line><span class=cl><span class=n>inverse_total_tmatrix</span> <span class=o>=</span> <span class=n>total_tmatrix</span><span class=o>.</span><span class=n>inv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>inverse_total_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Voltage gain response</span>
</span></span><span class=line><span class=cl><span class=n>voltage_gain_response</span> <span class=o>=</span> <span class=n>sp</span><span class=o>.</span><span class=n>simplify</span><span class=p>((</span><span class=mi>1</span><span class=o>/</span><span class=n>total_tmatrix</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>voltage_gain_response</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>Para visualizar la respuesta del sistema, primero debemos seleccionar valores para los componentes, en este caso se propone utilizar:</p><div>$$
\begin{align*}
R_1 &=& 3.1 ~ k\Omega \\
 R_2 &=& 100 ~ k\Omega \\
C_1 &=& 100 ~ nf \\
 C_2 &=& 1 ~ nf \\
\end{align*}
$$</div><p>A su vez, se debe seleccionar un rango de frecuencias a representar, y en función de dicho vector de frecuencias, generar las impedancias en función de la frecuencia de cada componente</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Components settings</span>
</span></span><span class=line><span class=cl><span class=n>R1_value</span> <span class=o>=</span> <span class=mi>3_100</span>
</span></span><span class=line><span class=cl><span class=n>R2_value</span> <span class=o>=</span> <span class=mi>100_000</span>
</span></span><span class=line><span class=cl><span class=n>C1_value</span> <span class=o>=</span> <span class=mf>100e-9</span>
</span></span><span class=line><span class=cl><span class=n>C2_value</span> <span class=o>=</span> <span class=mf>1e-9</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Frequency settings</span>
</span></span><span class=line><span class=cl><span class=n>freq_min</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>freq_max</span> <span class=o>=</span> <span class=mi>10_000</span>
</span></span><span class=line><span class=cl><span class=n>freq_bins</span> <span class=o>=</span> <span class=mi>2000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Frequency arrays</span>
</span></span><span class=line><span class=cl><span class=n>freq_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>freq_min</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>freq_max</span><span class=p>),</span> <span class=n>num</span><span class=o>=</span><span class=n>freq_bins</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>angular_freq_array</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>freq_array</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Impedances as function of frequency</span>
</span></span><span class=line><span class=cl><span class=n>R1_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)</span><span class=o>*</span><span class=n>R1_value</span>
</span></span><span class=line><span class=cl><span class=n>R2_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)</span><span class=o>*</span><span class=n>R2_value</span>
</span></span><span class=line><span class=cl><span class=n>X_C1_array</span> <span class=o>=</span> <span class=mi>1</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span><span class=n>j</span><span class=o>*</span><span class=n>C1_value</span><span class=o>*</span><span class=n>angular_freq_array</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>X_C2_array</span> <span class=o>=</span> <span class=mi>1</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span><span class=n>j</span><span class=o>*</span><span class=n>C2_value</span><span class=o>*</span><span class=n>angular_freq_array</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>Por último, se debe reemplazar los valores simbolicos de la expresión de ganancia por los vectores de impedancia generados.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Voltage gain array initialization</span>
</span></span><span class=line><span class=cl><span class=n>voltage_gain_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s2>&#34;complex&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Loop for replace the symbols by the values of the arrays</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>voltage_gain_i</span> <span class=o>=</span> <span class=n>voltage_gain</span><span class=o>.</span><span class=n>subs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>R1</span><span class=p>:</span> <span class=n>R1_array</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>X_C1</span><span class=p>:</span> <span class=n>X_C1_array</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>X_C2</span><span class=p>:</span> <span class=n>X_C2_array</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>R2</span><span class=p>:</span> <span class=n>R2_array</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>voltage_gain_array</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>voltage_gain_i</span>
</span></span></code></pre></div></li><li><p>Para visualizar la respuesta, se recomienda convertir la respuesta en magnitud del sistema a dB, y el eje de frecuencias configurarlo en escala logarítmica.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot for magnitude</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freq_array</span><span class=p>,</span> <span class=mi>20</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>voltage_gain_array</span><span class=p>)),</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Magnitude&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xscale</span><span class=p>(</span><span class=s1>&#39;log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&#34;Frequency [Hz]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Gain [dB]&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&#34;Band-pass response&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>top</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>labelcolor</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>which</span><span class=o>=</span><span class=s2>&#34;both&#34;</span><span class=p>,</span> <span class=n>ls</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot for phase</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>twinx</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;tab:red&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freq_array</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>angle</span><span class=p>(</span><span class=n>voltage_gain_array</span><span class=p>)</span><span class=o>*</span><span class=mi>180</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Phase&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Phase [º]&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>top</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>bottom</span><span class=o>=-</span><span class=mi>95</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>labelcolor</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>30</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>30</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>lines</span><span class=p>,</span> <span class=n>labels</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>get_legend_handles_labels</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lines2</span><span class=p>,</span> <span class=n>labels2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>get_legend_handles_labels</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>lines</span> <span class=o>+</span> <span class=n>lines2</span><span class=p>,</span> <span class=n>labels</span> <span class=o>+</span> <span class=n>labels2</span><span class=p>,</span> <span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>which</span><span class=o>=</span><span class=s2>&#34;both&#34;</span><span class=p>,</span> <span class=n>ls</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><figure><img src=/blog/posts/intro_to_transmission_matrices/images/bandpass-response.png></figure></li></ol><h2 id=ejemplo-3-filtro-resonante>Ejemplo 3: Filtro resonante</h2><p align=center><img src=https://upload.wikimedia.org/wikipedia/en/thumb/1/14/RLC_series_band-pass.svg/1280px-RLC_series_band-pass.svg.png alt=descripcion width=50%></p><p>Hasta ahora funciona todo espectacular, pero hay un aspecto no menor de todo el procesamiento anterior que es bastante molesto a la hora de experimentar con la herramienta, y es el tiempo de ejecución y costo computacional.</p><p>Como se puede observar en las celdas anteriores, el reemplazo de los valores frecuencia a frecuencia en la expresión simbólica toma mucho tiempo (30 segundos en promedio (es un monton)).</p><p>Esto se debe a que sympy es una muy buena herramienta para trabajar con expresiones matemáticas, pero no está optimizada para el cálculo vectorial. En cambio, trabajar con librerías como NumPy garantiza un mayor rendimiento ya que la mayoría de su código fuente está escrito en lenguajes de bajo nivel como C <a href=https://stackoverflow.com/questions/45796747/are-sympy-matrices-really-that-slow target=_blank rel="noopener noreffer">(Referencia)</a></p><p>Para el circuito resonante, vamos a encarar la resolución de forma vectorizada con NumPy.</p><ol><li><p>Ahora, al trabajar de forma vectorizada, ya no podremos inicializar un objeto simbolico y luego reemplazar valores, si no que la inicialización de las matrices debe ser con los valores de las impedancias frecuencia a frecuencia. Por lo tanto, cambia el orden en el que se definen las variables. Ahora, lo primero que debemos definir es el vector de frecuencia, en conjunto con los bines en frecuencia que queremos representar.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>freq_min</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>freq_max</span> <span class=o>=</span> <span class=mi>100_000</span>
</span></span><span class=line><span class=cl><span class=n>freq_bins</span> <span class=o>=</span> <span class=mi>2000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>freq_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>freq_min</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>freq_max</span><span class=p>),</span> <span class=n>num</span><span class=o>=</span><span class=n>freq_bins</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>angular_freq_array</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>freq_array</span>
</span></span></code></pre></div></li><li><p>Luego, debemos decidir que valores tendrán los componentes del circuito y generar los vectores de impedancia en función de la frecuencia para cada uno. En este caso se adoptan los siguientes valores:</p><div>$$
\begin{align*}
R =& 10 ~ \Omega \\
 L =& 1 ~ mH \\
 C =& 1 ~ \mu f \\
 \end{align*}
 $$
</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>R_value</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>L_value</span> <span class=o>=</span> <span class=mf>1e-3</span>
</span></span><span class=line><span class=cl><span class=n>C_value</span> <span class=o>=</span> <span class=mf>1e-6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)</span><span class=o>*</span><span class=n>R_value</span>
</span></span><span class=line><span class=cl><span class=n>X_L_array</span> <span class=o>=</span> <span class=mi>1</span><span class=n>j</span><span class=o>*</span><span class=n>angular_freq_array</span><span class=o>*</span><span class=n>L_value</span>
</span></span><span class=line><span class=cl><span class=n>X_C_array</span> <span class=o>=</span> <span class=mi>1</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span><span class=n>j</span><span class=o>*</span><span class=n>angular_freq_array</span><span class=o>*</span><span class=n>C_value</span><span class=p>)</span> 
</span></span></code></pre></div></li><li><p>Una vez definidas las impedancias, se conforman las matrices de transmisión de cada elemento. Para operar de forma vectorizada, ahora las matrices serán de:</p><div>$$
(2\times 2 \times \texttt{freq bins})
$$</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>X_L_tmatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>),</span> <span class=n>X_L_array</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)]]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_C_tmatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>),</span> <span class=n>X_C_array</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)]]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R_tmatrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[[</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=n>R_array</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>)]]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>R_tmatrix</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>Hasta este momento no hay mucha diferencia, pero ahora es cuando se complica (un poco) la cuestión. A la hora de hacer el producto matricial, ya no puedo usar métodos integrados a NumPy porque la multiplicación que necesitamos hacer no es muy común. Recordando que la multiplicación matricial entre dos matrices se puede hacer si la dimensión última dimensión de la primer matriz es igual a la primer dimensión de la segunda matriz, en este caso estamos al horno, porque todas las matrices de transmisión serán de $(2\times 2 \times \texttt{freq bins})$.</p><p>Para solucionar este problema, vamos a crear un producto que lo llamaremos &ldquo;Layer-Wise Dot Product&rdquo;, ya que estaremos haciendo el producto matricial (Dot product) por capas (Layer-Wise), es decir, vamos a calcular el producto para cada bin de frecuencia.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>layer_wise_dot_product</span><span class=p>(</span><span class=o>*</span><span class=n>matrices</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Performs the sequential layer-wise dot product of multiple 3D matrices along the last dimension.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>    *matrices: A variable number of 3D numpy arrays.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    A 3D numpy array containing the sequential dot product results for each layer in the last dimension.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=n>matrix</span><span class=o>.</span><span class=n>shape</span> <span class=o>==</span> <span class=n>matrices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span> <span class=k>for</span> <span class=n>matrix</span> <span class=ow>in</span> <span class=n>matrices</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;All matrices must have the same dimensions.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>matrices</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>num_layers</span> <span class=o>=</span> <span class=n>matrices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>layer_i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_layers</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Start the product with the identity matrix for the first multiplication</span>
</span></span><span class=line><span class=cl>        <span class=n>dot_product</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>matrix</span> <span class=ow>in</span> <span class=n>matrices</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>dot_product</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>dot_product</span><span class=p>,</span> <span class=n>matrix</span><span class=p>[:,</span> <span class=p>:,</span> <span class=n>layer_i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=p>[:,</span> <span class=p>:,</span> <span class=n>layer_i</span><span class=p>]</span> <span class=o>=</span> <span class=n>dot_product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div><p>Ahora si podemos obtener la transferencia haciendo la multiplicación sucesiva de las matrices de transmisión. La desventaja de trabajar de forma vectorizada y no simbolica, es que no tenemos la capacidad de visualizar las ecuaciones en función de los componentes, ahora simplemente observaremos una matriz compleja.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>total_tmatrix</span> <span class=o>=</span> <span class=n>layer_wise_dot_product</span><span class=p>(</span><span class=n>X_C_tmatrix</span><span class=p>,</span> <span class=n>X_L_tmatrix</span><span class=p>,</span> <span class=n>R_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>total_tmatrix</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>total_tmatrix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>([[[</span><span class=mf>1.</span>  <span class=o>-</span><span class=mf>1591.54314773</span><span class=n>j</span><span class=p>,</span> <span class=mf>1.</span>  <span class=o>-</span><span class=mf>1584.22696366</span><span class=n>j</span><span class=p>,</span> <span class=mf>1.</span>  <span class=o>-</span><span class=mf>1576.9444109</span><span class=n>j</span> <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=o>...</span><span class=p>,</span> <span class=mf>1.</span>    <span class=o>+</span><span class=mf>62.09489201</span><span class=n>j</span><span class=p>,</span> <span class=mf>1.</span>    <span class=o>+</span><span class=mf>62.38313291</span><span class=n>j</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=mf>1.</span>    <span class=o>+</span><span class=mf>62.67269813</span><span class=n>j</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mf>0.</span> <span class=o>-</span><span class=mf>15915.43147734</span><span class=n>j</span><span class=p>,</span> <span class=mf>0.</span> <span class=o>-</span><span class=mf>15842.26963657</span><span class=n>j</span><span class=p>,</span> <span class=mf>0.</span> <span class=o>-</span><span class=mf>15769.44410902</span><span class=n>j</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=o>...</span><span class=p>,</span> <span class=mf>0.</span>   <span class=o>+</span><span class=mf>620.94892013</span><span class=n>j</span><span class=p>,</span> <span class=mf>0.</span>   <span class=o>+</span><span class=mf>623.8313291</span><span class=n>j</span> <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=mf>0.</span>   <span class=o>+</span><span class=mf>626.72698129</span><span class=n>j</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=p>[[</span><span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=o>...</span><span class=p>,</span> <span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=mf>0.1</span>    <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=o>...</span><span class=p>,</span> <span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span> <span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=mf>1.</span>     <span class=o>+</span><span class=mf>0.</span><span class=n>j</span>        <span class=p>]]])</span>
</span></span></code></pre></div></li><li><p>Para graficar la respuesta de tensión en magnitud y fase del sistema, debemos obtener el array que representa la ganancia de tensión</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>voltage_gain_array</span> <span class=o>=</span> <span class=mi>1</span><span class=o>/</span><span class=n>total_tmatrix</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=p>:]</span>
</span></span></code></pre></div></li><li><p>Al igual que el ejemplo anterior, se recomienda convertir la respuesta en magnitud del sistema a dB, y el eje de frecuencias configurarlo en escala logarítmica.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot for Gain</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freq_array</span><span class=p>,</span> <span class=mi>20</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>voltage_gain_array</span><span class=p>)),</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Magnitude&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xscale</span><span class=p>(</span><span class=s1>&#39;log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&#34;Frequency [Hz]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Gain [dB]&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&#34;Resonant filter response&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>top</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>labelcolor</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>which</span><span class=o>=</span><span class=s2>&#34;both&#34;</span><span class=p>,</span> <span class=n>ls</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax2</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>twinx</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;tab:red&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freq_array</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>angle</span><span class=p>(</span><span class=n>voltage_gain_array</span><span class=p>)</span><span class=o>*</span><span class=mi>180</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Phase&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Phase [º]&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>top</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>bottom</span><span class=o>=-</span><span class=mi>95</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>labelcolor</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>30</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>30</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>lines</span><span class=p>,</span> <span class=n>labels</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>get_legend_handles_labels</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lines2</span><span class=p>,</span> <span class=n>labels2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>get_legend_handles_labels</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>lines</span> <span class=o>+</span> <span class=n>lines2</span><span class=p>,</span> <span class=n>labels</span> <span class=o>+</span> <span class=n>labels2</span><span class=p>,</span> <span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>which</span><span class=o>=</span><span class=s2>&#34;both&#34;</span><span class=p>,</span> <span class=n>ls</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><figure><img src=/blog/posts/intro_to_transmission_matrices/images/resonant-response.png></figure></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2024-04-01</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/ data-title="Introduction to Transmission Matrices"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://nahue-passano.github.io/blog/posts/intro_to_transmission_matrices/ data-title="Introduction to Transmission Matrices" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/blog/>Home</a></span></section></div><div class=post-nav></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.124.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://linkedin.com/in/nahuelpassano target=_blank>Nahuel Passano</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/blog/js/theme.min.js></script></body></html>