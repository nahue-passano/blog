<!DOCTYPE html>
<html lang="en">
    <head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Introduction to Transmission Matrices - </title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Introduction to Transmission Matrices" />
<meta property="og:description" content="This blog aims to introduce the concept and use of matrices that characterize two-port networks from a programmatic perspective. First, a theoretical and conceptual review is carried out, and then the development made with code is emulated, working symbolically and vectorially.
Two-port network Transmission matrices arise from the equations that characterize two-port networks. In general, the matrix that characterizes the transmission of a two-port network can be defined as::
$$ T =\begin{bmatrix} t_{11} & t_{12} \\ t_{21} & t_{22} \end{bmatrix} $$ where each value in the matrix $T$ represents a specific relationship between the input and output of the two-port network." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/blog/posts/intro_to_transmission_matrices/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-01T01:06:37-03:00" />
<meta property="article:modified_time" content="2024-04-01T01:06:37-03:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Introduction to Transmission Matrices"/>
<meta name="twitter:description" content="This blog aims to introduce the concept and use of matrices that characterize two-port networks from a programmatic perspective. First, a theoretical and conceptual review is carried out, and then the development made with code is emulated, working symbolically and vectorially.
Two-port network Transmission matrices arise from the equations that characterize two-port networks. In general, the matrix that characterizes the transmission of a two-port network can be defined as::
$$ T =\begin{bmatrix} t_{11} & t_{12} \\ t_{21} & t_{22} \end{bmatrix} $$ where each value in the matrix $T$ represents a specific relationship between the input and output of the two-port network."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/blog/posts/intro_to_transmission_matrices/" /><link rel="stylesheet" href="/blog/css/style.min.css"><link rel="preload" href="/blog/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/blog/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/blog/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/blog/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Introduction to Transmission Matrices",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/blog\/posts\/intro_to_transmission_matrices\/"
        },"genre": "posts","wordcount":  2636 ,
        "url": "http:\/\/localhost:1313\/blog\/posts\/intro_to_transmission_matrices\/","datePublished": "2024-04-01T01:06:37-03:00","dateModified": "2024-04-01T01:06:37-03:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Nahuel Passano"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/blog/" title="">nahue-passano&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blog/posts/"> Posts </a><a class="menu-item" href="/blog/about/"> About me </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/posts/intro_to_transmission_matrices/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/blog/" title="">nahue-passano&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/blog/posts/" title="">Posts</a><a class="menu-item" href="/blog/about/" title="">About me</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/posts/intro_to_transmission_matrices/" selected>English</option></select>
                </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Introduction to Transmission Matrices</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://linkedin.com/in/nahuelpassano" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Nahuel Passano</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-04-01">2024-04-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2636 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;13 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#two-port-network">Two-port network</a></li>
    <li><a href="#transmission-matrices">Transmission matrices</a></li>
    <li><a href="#example-1-voltage-divider">Example 1: Voltage Divider</a></li>
    <li><a href="#example-2-band-pass-filter">Example 2: Band-pass filter</a></li>
    <li><a href="#example-3-rlc-filter">Example 3: RLC filter</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>This blog aims to introduce the concept and use of matrices that characterize two-port networks from a programmatic perspective. First, a theoretical and conceptual review is carried out, and then the development made with code is emulated, working symbolically and vectorially.</p>
<h2 id="two-port-network">Two-port network</h2>
<p>Transmission matrices arise from the equations that characterize two-port networks. In general, the matrix that characterizes the transmission of a two-port network can be defined as::</p>
<div>
$$
    T =\begin{bmatrix}
    t_{11} & t_{12} \\
    t_{21} & t_{22}
    \end{bmatrix}
$$
</div>
<p>where each value in the matrix $T$ represents a specific relationship between the input and output of the two-port network.</p>
<div>
$$
    \begin{align*}
        t_{11} &= \frac{v_{in}}{v_{out}} \bigg|_{i_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_v)\\
        t_{12} &= \frac{v_{in}}{i_{out}} \bigg|_{i_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_Y)\\
        t_{21} &= \frac{i_{in}}{v_{out}} \bigg|_{v_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_Z)\\
        t_{22} &= \frac{i_{in}}{i_{out}} \bigg|_{v_{out} = 0} \hspace{8mm} \rightarrow \hspace{8mm} (1 / G_i)\\
    \end{align*}
$$
</div>
<p>As can be observed, there are two conditions under which the elements are specified:</p>
<p>$v_{out} = 0$: This indicates that the output voltage is zero, hence the output connectors are short-circuited.
$i_{out} = 0$: This implies that the output current is zero, thus the output connectors are open-circuited.
This matrix informs us about how to obtain the input variables in terms of the output variables:</p>
<div>
$$
    \begin{equation*}
        \begin{bmatrix}
            v_{in} \\
            i_{in}
        \end{bmatrix}
        =
        T \cdot
        \begin{bmatrix}
            v_{out} \\
            i_{out}
        \end{bmatrix}
        =
        \begin{bmatrix}
            t_{11} & t_{12} \\
            t_{21} & t_{22}
        \end{bmatrix}
        \cdot
        \begin{bmatrix}
            v_{out} \\
            i_{out}
        \end{bmatrix}
        =
        \begin{bmatrix}
            t_{11} \cdot v_{out} + t_{12} \cdot i_{out}\\
            t_{21} \cdot v_{out} + t_{22} \cdot i_{out}
        \end{bmatrix}
    \end{equation*}
$$
</div>
<p>Therefore, to obtain the output variables in terms of the input variables, we must invert the transmission matrix and apply it to the input variables (As long as the determinant of $T$ is different from 0).</p>
<div>
$$
    T^{-1} = 
    \frac{1}{\det(T)} \cdot
    \begin{bmatrix}
        t_{22} & -t_{12} \\
        -t_{21} & t_{11}
    \end{bmatrix}
$$
</div>
<div>
$$
    \begin{bmatrix}
        v_{in} \\
        i_{in}
    \end{bmatrix}
    =
    T \cdot
    \begin{bmatrix}
        v_{out} \\
        i_{out}
    \end{bmatrix}
    \hspace{4mm} \rightarrow \hspace{4mm}
    T^{-1} \cdot
    \begin{bmatrix}
        v_{in} \\
        i_{in}
    \end{bmatrix}
    =
    \begin{bmatrix}
        v_{out} \\
        i_{out}
    \end{bmatrix}
    =
    \begin{bmatrix}
        t_{22} \cdot v_{in} - t_{12} \cdot i_{in}\\
        -t_{21} \cdot v_{in} + t_{11} \cdot i_{in}
    \end{bmatrix}
    \cdot \frac{1}{\det(T)}
$$
</div>
<p>Moreover, to find the input or output impedance of the system through its respective transmission matrix, a load $Z_L$ is considered at the port opposite to the port being analyzed:</p>
<div>
$$
Z_{in} = \frac{t_{11}\cdot Z_L + t_{12}}{t_{21}\cdot Z_L + t_{22}}
$$
<p>$$
Z_{out} = \frac{t_{22}\cdot Z_L + t_{12}}{t_{21}\cdot Z_L + t_{11}}
$$</p>
</div>
<p>With the equations for the output voltage in terms of the input magnitudes and the input impedance, we can derive the formula to calculate the output voltage $v_{out}$ as a function of the input voltage and impedance.</p>
<div>
$$
v_{out} = t_{22} \cdot v_{in} - t_{12} \cdot i_{in} = t_{22} \cdot v_{in} - t_{12} \cdot \frac{v_{in}}{Z_{in}} = \Big ( t_{22} - \frac{t_{12}}{Z_{in}} \Big ) v_{in}
$$
</div>
<h2 id="transmission-matrices">Transmission matrices</h2>
<p>Each component within a circuit has its representation through a two-port network in matrix form. Generally, the matrix representation differs based on whether the components are impedance, admittance, or transformer-based.</p>
<p><strong>Series Impedance transmission matrix ($T_Z$)</strong></p>
<div>
$$
T_Z =
\begin{bmatrix}
    1 & Z \\
    0 & 1
\end{bmatrix}
$$
</div>
<p><strong>Parallel Admittance transmission matrix ($T_Y$)</strong></p>
<div>
$$
T_Y =
\begin{bmatrix}
    1 & 0 \\
    Y & 1
\end{bmatrix}
$$
</div>
<p><strong>Transformer transmission matrix ($T_T$)</strong></p>
<div>
$$
T_T =
\begin{bmatrix}
    n & 0 \\
    0 & 1/n
\end{bmatrix}
$$
</div>
<p><strong>Gyrator transmission matrix ($T_G$)</strong></p>
<div>
$$
T_G =
\begin{bmatrix}
    0 & n \\
    1/n & 0
\end{bmatrix}
$$
</div>
<p>Finally, the total transfer function of a system is obtained by successively multiplying the transmission matrices of each element. In general, for a system composed of $N$ elements, its transmission matrix will be:</p>
<div>
$$
T = \prod_{i=1}^{N} T_i
$$
</div>
<h2 id="example-1-voltage-divider">Example 1: Voltage Divider</h2>
<p>Let&rsquo;s consider analyzing the following resistive divider through the transmission matrices of each component to obtain the total transmission of the system.</p>
<p align="center">
  <img src="https://upload.wikimedia.org/wikipedia/commons/d/db/Resistive_divider.png" width="30%">
</p>
<p>The idea is to obtain an equation that relates the output quantities (output voltage and output current) in terms of the input quantities (input voltage and input current).</p>
<p>First, we need to define the matrices for both elements. In this case, $R_1$ is in series, but $R_2$ is in parallel with the output, so its transmission matrix should be of the admittance type.</p>
<div>
$$
    T_{R_1} =
    \begin{bmatrix}
        1 & R_1 \\
        0 & 1
    \end{bmatrix}
$$
</div>
<div>
$$
    T_{R_2} =
    \begin{bmatrix}
        1 & 0 \\
        \frac{1}{R_2} & 1
    \end{bmatrix}
$$
</div>
<p>By performing the successive multiplication of transmission matrices, the total transfer will be:</p>
<div>
$$
    T = T_{R_1} \cdot T_{R_2} = 
    \begin{bmatrix}
        1 & R_1 \\
        0 & 1
    \end{bmatrix}
    \cdot
    \begin{bmatrix}
        1 & 0 \\
        \frac{1}{R_2} & 1
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 + \frac{R_1}{R_2} & R_1 \\
        \frac{1}{R_2} & 1
    \end{bmatrix}
$$
</div>
<p>Based on the previously described equations, the relationship between the input and output magnitudes becomes:</p>
<div>
$$
    \begin{equation*}
        \begin{bmatrix}
            v_{in} \\
            i_{in}
        \end{bmatrix}
        =
        T \cdot
        \begin{bmatrix}
            v_{out} \\
            i_{out}
        \end{bmatrix}
        =
        \begin{bmatrix}
          1 + \frac{R_1}{R_2} & R_1 \\
          \frac{1}{R_2} & 1
        \end{bmatrix}
        \cdot
        \begin{bmatrix}
            v_{out} \\
            i_{out}
        \end{bmatrix}
        =
        \begin{bmatrix}
            (1 + \frac{R_1}{R_2}) \cdot v_{out} + R_{1} \cdot i_{out}\\
            \frac{1}{R_2} \cdot v_{out} + i_{out}
        \end{bmatrix}
    \end{equation*}
$$
</div>
<p>However, in most cases, what we care about is obtaining the output magnitudes as a function of the input magnitudes, so:</p>
<div>
$$
    T^{-1} = 
    \begin{bmatrix}
        1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
    \end{bmatrix}
    \cdot \underbrace{\det(T)}_{=1} =
    \begin{bmatrix}
        1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
    \end{bmatrix}
$$
</div>
<p>Now we can obtain the output voltage and current as a function of the input voltage and current.</p>
<div>
$$
    T^{-1} \cdot
    \begin{bmatrix}
        v_{in} \\
        i_{in}
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 & -R_1 \\
        -\frac{1}{R_2} & 1 + \frac{R_1}{R_2}
    \end{bmatrix}
    \cdot
    \begin{bmatrix}
        v_{in} \\
        i_{in}
    \end{bmatrix}
    =
    \begin{bmatrix}
        v_{out} \\
        i_{out}
    \end{bmatrix}
    =
    \begin{bmatrix}
        v_{in} - R_{1} \cdot i_{in}\\
        -\frac{1}{R_2} \cdot v_{in} + (1 + \frac{R_1}{R_2}) \cdot i_{in}
    \end{bmatrix}
$$
</div>
<div>
$$
    \begin{align*}
        v_{out} = v_{in} - R_{1} \cdot i_{in} = v_{in} - v_{R_1} \\
        i_{out} = \frac{1}{R_2} \Big ( -v_{in} + R_1 i_{in} + R_2 i_{in}\Big)
    \end{align*}
$$
</div>
<p>In Python, all this calculation can be done in several ways. One of them is using symbolic computation with the sympy library.</p>
<ol>
<li>
<p>The symbols to be used are defined and the transmission matrices for the circuit elements are generated.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R1</span><span class="p">,</span> <span class="n">R2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;R1 R2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R1_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">R1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R2_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">R2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>The total transmission is calculated by the successive multiplication of matrices.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Total transmission matrix</span>
</span></span><span class="line"><span class="cl"><span class="n">total_tmatrix</span> <span class="o">=</span> <span class="n">R1_tmatrix</span> <span class="o">*</span> <span class="n">R2_tmatrix</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">total_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Inverse total transmission matrix</span>
</span></span><span class="line"><span class="cl"><span class="n">inverse_total_tmatrix</span> <span class="o">=</span> <span class="n">total_tmatrix</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">inverse_total_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Voltage gain response</span>
</span></span><span class="line"><span class="cl"><span class="n">voltage_gain_response</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">voltage_gain_response</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>Multiplying the inverse transmission matrix by the input magnitudes gives:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">v_in</span><span class="p">,</span> <span class="n">i_in</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v_in i_in&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">output</span> <span class="o">=</span> <span class="n">inverse_total_tmatrix</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">v_in</span><span class="p">,</span> <span class="n">i_in</span><span class="p">])</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="example-2-band-pass-filter">Example 2: Band-pass filter</h2>
<p align="center">
  <img src="https://www.researchgate.net/profile/Jonathan-Estevez-Fernandez/publication/312549075/figure/fig3/AS:452414026326019@1484875317721/Figura-5-Filtro-pasa-banda.png" width="70%">
</p>
<ol>
<li>
<p>The symbols to be used are defined and the transmission matrices for the circuit elements are generated.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C2</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="n">R2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;X_C1 X_C2 R1 R2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_C1_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R1_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">R1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R2_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">R2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_C2_tmatrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">X_C2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>The total transmission is calculated by the successive multiplication of matrices. In this case, the magnitude and phase response of the system voltage is sought, so the expression for the voltage gain must be obtained from the transmission matrix.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Total transmission matrix</span>
</span></span><span class="line"><span class="cl"><span class="n">total_tmatrix</span> <span class="o">=</span> <span class="n">X_C1_tmatrix</span> <span class="o">*</span> <span class="n">R1_tmatrix</span> <span class="o">*</span> <span class="n">R2_tmatrix</span> <span class="o">*</span> <span class="n">X_C2_tmatrix</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">total_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Inverse total transmission matrix</span>
</span></span><span class="line"><span class="cl"><span class="n">inverse_total_tmatrix</span> <span class="o">=</span> <span class="n">total_tmatrix</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">inverse_total_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Voltage gain response</span>
</span></span><span class="line"><span class="cl"><span class="n">voltage_gain_response</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">voltage_gain_response</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>To visualize the response of the system, we must first select values for the components, in this case it is proposed to use:</p>
 <div>
 $$
 \begin{align*}
 R_1 &=& 3.1 ~ k\Omega \\
 R_2 &=& 100 ~ k\Omega \\
 C_1 &=& 100 ~ nf \\
 C_2 &=& 1 ~ nf \\
 \end{align*}
 $$
 </div>
<p>In turn, a range of frequencies to be represented must be selected, and based on this frequency vector, the impedances must be generated as a function of the frequency for each component.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Components settings</span>
</span></span><span class="line"><span class="cl"><span class="n">R1_value</span> <span class="o">=</span> <span class="mi">3_100</span>
</span></span><span class="line"><span class="cl"><span class="n">R2_value</span> <span class="o">=</span> <span class="mi">100_000</span>
</span></span><span class="line"><span class="cl"><span class="n">C1_value</span> <span class="o">=</span> <span class="mf">100e-9</span>
</span></span><span class="line"><span class="cl"><span class="n">C2_value</span> <span class="o">=</span> <span class="mf">1e-9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Frequency settings</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_min</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_max</span> <span class="o">=</span> <span class="mi">10_000</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_bins</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Frequency arrays</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">freq_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">freq_max</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="n">freq_bins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">angular_freq_array</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq_array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Impedances as function of frequency</span>
</span></span><span class="line"><span class="cl"><span class="n">R1_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)</span><span class="o">*</span><span class="n">R1_value</span>
</span></span><span class="line"><span class="cl"><span class="n">R2_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)</span><span class="o">*</span><span class="n">R2_value</span>
</span></span><span class="line"><span class="cl"><span class="n">X_C1_array</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">C1_value</span><span class="o">*</span><span class="n">angular_freq_array</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">X_C2_array</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">C2_value</span><span class="o">*</span><span class="n">angular_freq_array</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>Finally, the symbolic values of the gain expression must be replaced by the generated impedance vectors.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Voltage gain array initialization</span>
</span></span><span class="line"><span class="cl"><span class="n">voltage_gain_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&#34;complex&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Loop for replace the symbols by the values of the arrays</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">voltage_gain_i</span> <span class="o">=</span> <span class="n">voltage_gain</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">R1</span><span class="p">:</span> <span class="n">R1_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">X_C1</span><span class="p">:</span> <span class="n">X_C1_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">X_C2</span><span class="p">:</span> <span class="n">X_C2_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">R2</span><span class="p">:</span> <span class="n">R2_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">voltage_gain_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">voltage_gain_i</span>
</span></span></code></pre></div></li>
<li>
<p>To visualize the response, it is recommended to convert the response of the system magnitude in dB, and to configure the frequency axis in logarithmic scale.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plot for magnitude</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">voltage_gain_array</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Magnitude&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Frequency [Hz]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;Gain [dB]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Band-pass response&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plot for phase</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">voltage_gain_array</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Phase&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;Phase [º]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=-</span><span class="mi">95</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">lines</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><figure><img src="/blog/posts/intro_to_transmission_matrices/images/bandpass-response.png">
    </figure>

</li>
</ol>
<h2 id="example-3-rlc-filter">Example 3: RLC filter</h2>
<p align="center">
  <img src="https://upload.wikimedia.org/wikipedia/en/thumb/1/14/RLC_series_band-pass.svg/1280px-RLC_series_band-pass.svg.png" alt="descripcion" width="50%">
</p>
<p>So far everything is working great, but there is a not insignificant aspect of all the previous processing that is quite annoying when experimenting with the tool, and that is the execution time and computational cost.</p>
<p>As can be seen in the previous cells, replacing the values frequency by frequency in the symbolic expression takes a long time (30 seconds on average (it&rsquo;s a lot)).</p>
<p>This is because sympy is a very good tool for working with mathematical expressions, but it is not optimized for vector calculation. Instead, working with libraries like NumPy ensures higher performance since most of its source code is written in low-level languages such as C <a href="https://stackoverflow.com/questions/45796747/" target="_blank" rel="noopener noreffer ">[1]</a></p>
<p>For the resonant circuit, we will approach the resolution in a vectorized way with NumPy.</p>
<ol>
<li>
<p>Now, when working in a vectorized way, we won&rsquo;t be able to initialize a symbolic object and then replace values, but rather the initialization of the matrices must be with the values of the impedances frequency by frequency. Therefore, change the order in which the variables are defined. Now, the first thing we must define is the frequency vector, together with the frequency bins we want to represent.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">freq_min</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_max</span> <span class="o">=</span> <span class="mi">100_000</span>
</span></span><span class="line"><span class="cl"><span class="n">freq_bins</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">freq_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">freq_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">freq_max</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="n">freq_bins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">angular_freq_array</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq_array</span>
</span></span></code></pre></div></li>
<li>
<p>Then, we must decide on the values that the circuit components will have and generate the impedance vectors as a function of frequency for each one. In this case, we adopt the following values:</p>
 <div>
 $$
 \begin{align*}
 R =& 10 ~ \Omega \\
 L =& 1 ~ mH \\
 C =& 1 ~ \mu f \\
 \end{align*}
 $$
 </div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">R_value</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">L_value</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span></span><span class="line"><span class="cl"><span class="n">C_value</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)</span><span class="o">*</span><span class="n">R_value</span>
</span></span><span class="line"><span class="cl"><span class="n">X_L_array</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">angular_freq_array</span><span class="o">*</span><span class="n">L_value</span>
</span></span><span class="line"><span class="cl"><span class="n">X_C_array</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">angular_freq_array</span><span class="o">*</span><span class="n">C_value</span><span class="p">)</span> 
</span></span></code></pre></div></li>
<li>
<p>Once the impedances are defined, the transmission matrices of each element are formed. To operate in a vectorized way, the matrices will now have a shape of:</p>
 <div>
 $$
 (2\times 2 \times \texttt{freq bins})
 $$
 </div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">X_L_tmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">),</span> <span class="n">X_L_array</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)]]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">X_C_tmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">),</span> <span class="n">X_C_array</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)]]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R_tmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">R_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">)]]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">R_tmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>Up to this point, there isn&rsquo;t much difference, but now is when the issue gets a bit complicated. When it comes to doing the matrix product, I can no longer use built-in NumPy methods because the multiplication we need to do is not very common. Remembering that matrix multiplication between two matrices can be done if the last dimension of the first matrix is equal to the first dimension of the second matrix, in this case, we&rsquo;re stuck, because all the transmission matrices will be of $(2\times 2 \times \texttt{freq bins})$.</p>
<p>To solve this problem, we will create a product that we will call &ldquo;Layer-Wise Dot Product&rdquo;, since we will be performing the matrix product (Dot product) layer by layer, that is, we will calculate the product for each frequency bin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">layer_wise_dot_product</span><span class="p">(</span><span class="o">*</span><span class="n">matrices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Performs the sequential layer-wise dot product of multiple 3D matrices along the last dimension.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">    *matrices: A variable number of 3D numpy arrays.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">    A 3D numpy array containing the sequential dot product results for each layer in the last dimension.
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">matrices</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;All matrices must have the same dimensions.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">num_layers</span> <span class="o">=</span> <span class="n">matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">layer_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Start the product with the identity matrix for the first multiplication</span>
</span></span><span class="line"><span class="cl">        <span class="n">dot_product</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">matrices</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">dot_product</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dot_product</span><span class="p">,</span> <span class="n">matrix</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">layer_i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">layer_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dot_product</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span></code></pre></div><p>Now we can obtain the transfer function by successively multiplying the transmission matrices. The disadvantage of working in a vectorized way rather than symbolically is that we don&rsquo;t have the ability to visualize the equations in terms of the components; now we will simply observe a complex matrix.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">total_tmatrix</span> <span class="o">=</span> <span class="n">layer_wise_dot_product</span><span class="p">(</span><span class="n">X_C_tmatrix</span><span class="p">,</span> <span class="n">X_L_tmatrix</span><span class="p">,</span> <span class="n">R_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">total_tmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">total_tmatrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output:</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">array</span><span class="p">([[[</span><span class="mf">1.</span>  <span class="o">-</span><span class="mf">1591.54314773</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span>  <span class="o">-</span><span class="mf">1584.22696366</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span>  <span class="o">-</span><span class="mf">1576.9444109</span><span class="n">j</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">,</span> <span class="mf">1.</span>    <span class="o">+</span><span class="mf">62.09489201</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span>    <span class="o">+</span><span class="mf">62.38313291</span><span class="n">j</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mf">1.</span>    <span class="o">+</span><span class="mf">62.67269813</span><span class="n">j</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mf">0.</span> <span class="o">-</span><span class="mf">15915.43147734</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span><span class="mf">15842.26963657</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span><span class="mf">15769.44410902</span><span class="n">j</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span>   <span class="o">+</span><span class="mf">620.94892013</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span>   <span class="o">+</span><span class="mf">623.8313291</span><span class="n">j</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mf">0.</span>   <span class="o">+</span><span class="mf">626.72698129</span><span class="n">j</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="p">[[</span><span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">,</span> <span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mf">0.1</span>    <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">,</span> <span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span> <span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mf">1.</span>     <span class="o">+</span><span class="mf">0.</span><span class="n">j</span>        <span class="p">]]])</span>
</span></span></code></pre></div></li>
<li>
<p>To plot the voltage response in magnitude and phase of the system, we need to obtain the array representing the voltage gain.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">voltage_gain_array</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span></span></code></pre></div></li>
<li>
<p>Similarly to the previous example, it is recommended to convert the system&rsquo;s magnitude response to dB, and configure the frequency axis in a logarithmic scale.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plot for Gain</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">voltage_gain_array</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Magnitude&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Frequency [Hz]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;Gain [dB]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Resonant filter response&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">voltage_gain_array</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Phase&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;Phase [º]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=-</span><span class="mi">95</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">lines</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><figure><img src="/blog/posts/intro_to_transmission_matrices/images/resonant-response.png">
    </figure>

</li>
<li>
<p>To simulate the signal processing through the circuit, we need to obtain the input impedance. To do this, a load impedance must be established. In this case, we will analyze an open circuit, so:</p>
 <div>
 $$
 Z_L = \infty
 $$
<p>If the load impedance is infinite, then the expression for the input impedance is:</p>
<p>$$
Z_{in} = \frac{t_{11}}{t_{21}}
$$</p>
 </div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Input impedance</span>
</span></span><span class="line"><span class="cl"><span class="n">input_impedance</span> <span class="o">=</span> <span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">/</span> <span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span>
</span></span></code></pre></div></li>
<li>
<p>With the input impedance defined, we can find the output voltage as a function of the input voltage chosen. In this case, the system is excited with white noise of 2.83 $V_{rms}$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># White noise of 2.83 V RMS</span>
</span></span><span class="line"><span class="cl"><span class="n">input_voltage</span> <span class="o">=</span> <span class="mf">2.83</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">output_voltage</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">total_tmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="n">input_impedance</span><span class="p">)</span> <span class="o">*</span> <span class="n">input_voltage</span>
</span></span></code></pre></div></li>
<li>
<p>When plotting the output, the unit of measurement is the same as the input unit of measurement ($V_{rms}$).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plot for Gain</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output_voltage</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Magnitude&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Frequency [Hz]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Output voltage [$V_{\mathrm</span><span class="si">{rms}</span><span class="s2">}$]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;System&#39;s output to white noise ($2.83~V_{\mathrm</span><span class="si">{rms}</span><span class="s2">}$)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">output_voltage</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Phase&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;Phase [º]&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=-</span><span class="mi">95</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">lines</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&#34;--&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><figure><img src="/blog/posts/intro_to_transmission_matrices/images/system-output.png">
    </figure>

</li>
</ol>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-04-01</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://localhost:1313/blog/posts/intro_to_transmission_matrices/" data-title="Introduction to Transmission Matrices"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/blog/posts/intro_to_transmission_matrices/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/blog/posts/intro_to_transmission_matrices/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="http://localhost:1313/blog/posts/intro_to_transmission_matrices/" data-title="Introduction to Transmission Matrices" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/blog/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.124.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://linkedin.com/in/nahuelpassano" target="_blank">Nahuel Passano</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/blog/lib/katex/katex.min.css"><script type="text/javascript" src="/blog/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/blog/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/blog/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/blog/lib/katex/katex.min.js"></script><script type="text/javascript" src="/blog/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/blog/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/blog/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/blog/js/theme.min.js"></script></body>
</html>
